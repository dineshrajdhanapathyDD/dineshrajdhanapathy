{% comment %}
Responsive image include with fallback support
Usage: {% include responsive-image.html src=post.image alt=post.image_alt class="custom-class" %}
{% endcomment %}

{% assign image_src = include.src %}
{% assign image_alt = include.alt | default: "Blog post image" %}
{% assign image_class = include.class | default: "" %}
{% assign loading = include.loading | default: "lazy" %}
{% assign sizes = include.sizes | default: "(max-width: 768px) 100vw, (max-width: 1200px) 80vw, 1200px" %}

{% comment %} Check if image exists, otherwise use fallback {% endcomment %}
{% unless image_src %}
  {% assign image_src = "/assets/images/blog/default-post.svg" %}
  {% assign image_alt = "Default blog post image" %}
{% endunless %}

{% comment %} Generate responsive image with multiple formats if supported {% endcomment %}
<picture class="responsive-image {{ image_class }}">
  {% comment %} WebP format for modern browsers {% endcomment %}
  {% if image_src contains '.jpg' or image_src contains '.jpeg' or image_src contains '.png' %}
    {% assign webp_src = image_src | replace: '.jpg', '.webp' | replace: '.jpeg', '.webp' | replace: '.png', '.webp' %}
    <source srcset="{{ webp_src | relative_url }}" type="image/webp">
  {% endif %}
  
  {% comment %} Original format as fallback {% endcomment %}
  <img 
    src="{{ image_src | relative_url }}" 
    alt="{{ image_alt }}"
    class="responsive-image__img {{ image_class }}"
    loading="{{ loading }}"
    sizes="{{ sizes }}"
    {% if include.width %}width="{{ include.width }}"{% endif %}
    {% if include.height %}height="{{ include.height }}"{% endif %}
    {% if include.itemprop %}itemprop="{{ include.itemprop }}"{% endif %}
  >
</picture>
class PerformanceMonitor{constructor(){this.metrics={};this.init()}init(){if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',()=>this.collectMetrics());window.addEventListener('load',()=>this.collectLoadMetrics())}else{this.collectMetrics();this.collectLoadMetrics()}}collectMetrics(){if(!window.performance||!window.performance.timing){return}const timing=window.performance.timing;const navigation=window.performance.navigation;this.metrics={navigationStart: timing.navigationStart,domainLookup: timing.domainLookupEnd-timing.domainLookupStart,serverConnect: timing.connectEnd-timing.connectStart,serverResponse: timing.responseEnd-timing.requestStart,domProcessing: timing.domComplete-timing.domLoading,timeToFirstByte: timing.responseStart-timing.navigationStart,domContentLoaded: timing.domContentLoadedEventEnd-timing.navigationStart,windowLoad: timing.loadEventEnd-timing.navigationStart,navigationType: navigation.type,redirectCount: navigation.redirectCount};this.metrics.totalPageLoad=this.metrics.windowLoad;this.metrics.criticalRenderingPath=this.metrics.domContentLoaded;if(this.isDevelopment()){this.logPerformanceMetrics()}}collectLoadMetrics(){if(window.performance&&window.performance.getEntriesByType){const resources=window.performance.getEntriesByType('resource');this.metrics.resources={total: resources.length,css: resources.filter(r=>r.name.includes('.css')).length,js: resources.filter(r=>r.name.includes('.js')).length,images: resources.filter(r=>/\.(jpg|jpeg|png|gif|webp|svg)/.test(r.name)).length,fonts: resources.filter(r=>/\.(woff|woff2|ttf|otf)/.test(r.name)).length};this.metrics.resourceLoadTime=Math.max(...resources.map(r=>r.responseEnd))-Math.min(...resources.map(r=>r.startTime))}if(window.performance&&window.performance.getEntriesByType){const paintEntries=window.performance.getEntriesByType('paint');paintEntries.forEach(entry=>{this.metrics[entry.name.replace('-','')]=entry.startTime})}}isDevelopment(){return window.location.hostname==='localhost'||window.location.hostname==='127.0.0.1'||window.location.hostname.includes('github.io')}logPerformanceMetrics(){console.group('ðŸš€ Performance Metrics');console.log('Time to First Byte:',this.formatTime(this.metrics.timeToFirstByte));console.log('DOM Content Loaded:',this.formatTime(this.metrics.domContentLoaded));console.log('Window Load:',this.formatTime(this.metrics.windowLoad));if(this.metrics.firstpaint){console.log('First Paint:',this.formatTime(this.metrics.firstpaint))}if(this.metrics.firstcontentfulpaint){console.log('First Contentful Paint:',this.formatTime(this.metrics.firstcontentfulpaint))}console.log('Resources Loaded:',this.metrics.resources?.total||'N/A');console.groupEnd();this.checkPerformanceThresholds()}checkPerformanceThresholds(){const warnings=[];if(this.metrics.timeToFirstByte>1000){warnings.push('âš ï¸ Slow server response time(TTFB>1s)')}if(this.metrics.domContentLoaded>2000){warnings.push('âš ï¸ Slow DOM processing(DOMContentLoaded>2s)')}if(this.metrics.windowLoad>3000){warnings.push('âš ï¸ Slow page load(Window Load>3s)')}if(this.metrics.resources?.total>50){warnings.push('âš ï¸ Too many HTTP requests('+this.metrics.resources.total+')')}if(warnings.length>0){console.group('âš ï¸ Performance Warnings');warnings.forEach(warning=>console.warn(warning));console.groupEnd()}}formatTime(milliseconds){if(milliseconds<1000){return Math.round(milliseconds)+'ms'}return(milliseconds/1000).toFixed(2)+'s'}getMetrics(){return this.metrics}sendMetrics(endpoint){if(!endpoint)return;const payload={url: window.location.href,userAgent: navigator.userAgent,timestamp: Date.now(),metrics: this.metrics};if(navigator.sendBeacon){navigator.sendBeacon(endpoint,JSON.stringify(payload))}else{fetch(endpoint,{method: 'POST',headers:{'Content-Type': 'application/json'},body: JSON.stringify(payload)}).catch(()=>{})}}}class ResourceOptimizer{static preloadCriticalResources(){const criticalFonts=[ ];criticalFonts.forEach(fontUrl=>{const link=document.createElement('link');link.rel='preload';link.href=fontUrl;link.as='font';link.type='font/woff2';link.crossOrigin='anonymous';document.head.appendChild(link)})}static lazyLoadImages(){if('IntersectionObserver' in window){const imageObserver=new IntersectionObserver((entries,observer)=>{entries.forEach(entry=>{if(entry.isIntersecting){const img=entry.target;if(img.dataset.src){img.src=img.dataset.src;img.removeAttribute('data-src')}if(img.dataset.srcset){img.srcset=img.dataset.srcset;img.removeAttribute('data-srcset')}img.classList.remove('lazy');observer.unobserve(img)}})},{rootMargin: '50px 0px',threshold: 0.01});document.querySelectorAll('img[data-src]').forEach(img=>{imageObserver.observe(img)})}}static optimizeThirdPartyScripts(){const delayedScripts=[];let userInteracted=false;const loadDelayedScripts=()=>{if(userInteracted)return;userInteracted=true;delayedScripts.forEach(script=>{const newScript=document.createElement('script');newScript.src=script.src;if(script.async)newScript.async=true;if(script.defer)newScript.defer=true;document.head.appendChild(newScript)})};['mousedown','mousemove','keypress','scroll','touchstart','click'].forEach(event=>{document.addEventListener(event,loadDelayedScripts,{once: true,passive: true})});setTimeout(loadDelayedScripts,5000)}}const performanceMonitor=new PerformanceMonitor();document.addEventListener('DOMContentLoaded',()=>{ResourceOptimizer.preloadCriticalResources();ResourceOptimizer.lazyLoadImages();ResourceOptimizer.optimizeThirdPartyScripts()});if(typeof module!=='undefined'&&module.exports){module.exports={PerformanceMonitor,ResourceOptimizer}}